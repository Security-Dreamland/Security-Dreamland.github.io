---


title: 《IDA Pro权威指南》阅读笔记

time: 2016.08.17 15:22:00

layout: post

tags:

- Security
- 安全工具
- 逆向
- IDA

excerpt: 最近想学一些二进制相关安全的项目，所以去图书馆借了本IDA相关的书。这里权且写个笔记

---

# 《IDA Pro权威指南》阅读笔记

## 基础简介

1. 动态分析是指在严格控制的环境（沙盒）中执行恶意软件，并使用系统检查实用工具记录其所有行为
2. 静态分析则试图通过浏览程序代码来理解程序的行为。
3. 汇编语法中存在两种：AT&T和Intel语法。AT&T汇编语法以％作为所有寄存器名称的前缀，以$作为文字常量（也叫立即操作数）的前缀。且源操作数位于左边，目的操作数位于右边。如：add $0x4,%eax  而Intel语法不需要寄存器和文字前缀，且操作数排序方式与前者相反，如add eax,0x4
4. 常见的反汇编算法：
	1. 线性扫描反汇编：其采用一个非常简单的方法来确定需要反汇编指令的位置：一条指令结束、即为另一条指令开始的地方。反汇编从一个代码段的第一个字节开始，以线性模式扫描整个代码段，逐条反汇编每条指令，直到完成整个代码段。 优点：能够完全覆盖程序的所有代码段 缺点：没有考虑到代码中可能混有数据
	2. 递归下降反汇编：它采用以下算法来定位指令：控制流根据一条指令是否被另一条指令引用来决定是否对其进行反汇编。优点：具有区分代码和数据的强大能力
	
## IDA数据库文件

IDA分析可执行文件时，会建立一个数据库，其组件分别保存在4个文件，后缀依次是.id0,.id1,.nam和.til。 .id0文件是一个二叉树形式的数据库，.id1文件包含描述每个程序字节的标记。.nam文件包含与IDA的Names窗口中显示的给定程序位置有关的索引信息。最后,.til文件用于储存与一个给定数据库的本地类型定义有关的信息。

## IDA数据显示窗口

### 1. 反汇编窗口

（1）图形视图

程序流图展示

对于条件分支，Yes边的箭头默认为绿色，No边的箭头为红色。

只有一个后继块的基本块会利用一个正常边（默认为蓝色）只想下一个即将执行的块

（2）文本视图

文本显示窗口会呈现一个程序的完整反汇编代码清单，用户只有通过这个窗口才能查看一个二进制文件的数据部分。

在文本视图中，左边会有箭头窗口，用于描述函数中的非线性流程。实线箭头表示非条件跳转，虚线箭头则表示条件跳转，如果一个跳转将控制权转交给程序中的某个地址（以前的），这时会使用粗线（实线或虚线）。出现这类逆向流程，通常表示程序中存在循环


代码交叉引用，表示另一个程序指令将控制权转交给交叉引用注释所在位置的指令。


### 2. 函数窗口

Functions窗口用于列举IDA在数据库中识别的每一个函数。


### 3. 输出窗口

输出窗口时IDA的输出控制台，从中可以找到与IDA所执行的任务有关的信息。

### 4. HEX窗口

显示整个二进制文件的16进制，便于显示。同时，也可以在这个窗口下对二进制文件进行编辑。此外，这里有一个HEX窗口与反汇编窗口同步的功能。

### 5. 导出窗口

导出窗口列出文件的入口点。包括程序的执行入口点，以及任何由文件导出给其他文件实用的函数和变量。

### 6. 导入窗口

它会列出由被分析的二进制文件导入的所有函数。只有在二进制文件使用共享库时，IDA才需要用到导入窗口。

导入窗口仅显示二进制文件想要动态加载起自动处理的符号，二进制文件选择使用dlopen/dlsym或LoadLibrary／GetProcAddress等机制自行加载的符号将不会在导入窗口显示。


### 7. 结构体窗口


用于显示IDA决定在一个二进制文件中使用的任何复杂的数据结构



### 8. 枚举窗口

如果IDA检测到标准枚举数据类型，它将在枚举窗口中列出该数据类型。


### 9. Strings 窗口

会显示从二进制文件中提取出的一组字符串，以及每个字符串所在的地址。


### 10. Names 窗口

简要列举一个二进制文件中的所有全局名称。

F,常规函数。

L，库函数。IDA通过签名匹配算法来识别库函数。

I，导入的名称，通常为共享库导入的函数名称。它与库函数的区别在于：导入的名称没有代码，而库函数的主题将在反汇编代码清单中显示

C，命名代码。这些是已命名的程序指令位置，IDA认为它们不属于任何函数


D，数据。已命名数据的位置通常表示全局变量。


A，字符串数据。这是一个被引用的数据位置，其中包含一串字符符合IDA的某种已知的字符串数据类型。

### 11. 段窗口

段窗口显示的是在二进制文件中出现的简要列表

### 12. 签名窗口

IDA利用一个庞大的签名库来识别已知的代码块。签名用于识别由编译器生成的常用启动顺序，以确定可能已被用来构建给定二进制文件的编译器。

### 13. 类型库窗口

类型库保存IDA积累的一些信息，即IDA从最常用的编译器的头文件中搜集到的有关预订一数据类型和函数原型的信息，

### 14. 函数调用窗口

如题所示

### 15.  问题窗口

IDA会在问题窗口中显示它在反汇编二进制文件时遇到的困难，以及它如何处理这些困难。