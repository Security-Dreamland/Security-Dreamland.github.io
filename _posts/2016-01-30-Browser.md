---
title: 浅谈浏览器工作原理
time: 2016.01.30 14:47:00
layout: post
tags:
- Web
- 浏览器
excerpt: 该博文主要从浏览器的工作原理分析
    
---
## 浅谈浏览器工作原理
### 浏览器的结构
浏览器主要有以下几个组件：

1. 用户界面/User Interface
	包括浏览器主窗口、地址栏、前进/后退/停止/刷新等按钮、收藏夹等，其他显示的各个部分也都属于用户界面。
2. 浏览器引擎/Browser Engine
	处于用户界面和渲染引擎之间，负责在两者之间传递操作。
3. 渲染引擎/Rendering Engine
	负责显示请求的内容，对于HTML，就负责解析 HTML 和 CSS 内容，并将解析后的内容显示在屏幕上。
4. 网络/Networking
	用于网络调用，比如 HTTP 请求。
5. 用户界面后端/UI Backend
	用于绘制基本的窗口小部件，比如下拉框和窗口。
6. JavaScript解释器/JavaScript Interpreter
	解析和执行 JavaScript代码。
7. 数据存储/Data Storage
	这是数据持久层，浏览器需要将数据保存到本地硬盘，比如Cookie，浏览器还可以支持 localStorage, IndexedDB, WebSQL和FileSystem。
	
	![image](http://momomoxiaoxi.com/img/post/browser/1.png)
	注：Chrome浏览器的每个标签页都分别对应一个渲染引擎实例，每个标签页都是一个进程（一定程度上，这就是为什么chrome浏览器比较占内存的原因）

---
###渲染引擎

渲染引擎，我们一般也称为浏览器内核，可以说是浏览器最重要的一个模块。
Firefox使用基于Mozilla的Gecko，而Safari和Chrome使用的是Webkit。渲染引擎主要工作就是依据HTMl、XML、CSS等代码文档的描述，把页面显示出来。 	

####渲染引擎的基本流程
 
 1.  首先，渲染引擎会通过Networking组件获取请求的内容（HTML CSS JS代码之类的）
 2. 获取到内容后，渲染引擎会进行下列流程
 	![image](http://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/flow.png)
 	1. 对HTML文档进行解析，构造“DOM树”，并将各个标签转化为内容树的DOM节点
 	2. 再解析来自内部和外部的CSS数据＋HTML中带有视觉效果的指令，构建“渲染树（Render Tree）”，渲染树包含多个带有视觉属性（如颜色和尺寸）的矩形和矩形间的前后排列顺序。
 	3. 然后，进入布局阶段，即为每一个节点分配一个应出现在屏幕上的确切坐标。
 	4. 最后就是绘制渲染树，渲染引擎会遍历渲染树，通过用户界面后端，将节点绘制出来。
 	注：上面是大体流程，但实际情况，该流程并不是严格的顺序的。通俗讲就是，这是一个渐进的过程。为达到更好的用户体验，呈现引擎会力求尽快将内容显示在屏幕上。但它不必等到整个 HTML 文档解析完毕之后，就会开始构建呈现树和设置布局。在不断接收和处理来自网络的其余内容的同时，呈现引擎会将部分内容解析并显示出来。
 	
####  主流程范例

![image](http://momomoxiaoxi.com/img/post/browser/2.png)

Webkit主要流程

![image](http://momomoxiaoxi.com/img/post/browser/3.png)
 	
 	
 	
 	
 	
 	
 	
### 参考

1. http://feit.topming.com/how-modern-web-browsers-work/
2. http://taligarsiel.com/Projects/howbrowserswork1.htm